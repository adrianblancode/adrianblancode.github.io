
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Runner</title>
<meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<style>
body {
	font-family: helvetica, arial, sans serif;
}
</style>
</head>

<body>
<div id="content">
<p>Rotation: <span id="rotation"></span></p>

<img src="up-arrow.svg" onclick="javascript:doSend('jump')"style="width:100%";/>

</div>
<script type="text/javascript">

	var rotation = 0;

	if (window.DeviceMotionEvent != undefined) {
		window.ondevicemotion = function(e) {
			rotation = e.accelerationIncludingGravity.y;
			document.getElementById("rotation").innerHTML = rotation;
		}
	} 

  function init() {
	 doConnect();
  }

  function doConnect() {

  	var url = "ws://178.62.226.87:8000/";

    websocket = new WebSocket(url);
    websocket.onopen = function(evt) { onOpen(evt) };
    websocket.onclose = function(evt) { onClose(evt) };
    websocket.onmessage = function(evt) { onMessage(evt) };
    websocket.onerror = function(evt) { onError(evt) };
  }

  function onOpen(evt)
  {
  writeToScreen("connected\n");
  }

  function onClose(evt)
  {
    writeToScreen("disconnected\n");
  }

  function onMessage(evt)
  {
    writeToScreen("response: " + evt.data + '\n');
  }

  function onError(evt)
  {
    writeToScreen('error: ' + evt.data + '\n');
	 websocket.close();
  }

  function doSend(message)
  {
    writeToScreen("sent: " + message + '\n'); 
    websocket.send(message);
  }

  function writeToScreen(message) {
    console.log(message);
  }

  window.addEventListener("load", init, false);

  var interval = setInterval(
    function () { 
      doSend(String("rotation - " + rotation));
    },  0.1 * 1000);

</script>

</body>
</html>

